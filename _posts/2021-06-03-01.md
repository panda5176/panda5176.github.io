---
layout: post
title: C++ Rosalind iprb - Mendel's First Law
category: C++
---

[http://rosalind.info/problems/iprb/](http://rosalind.info/problems/iprb/)

문제가 조금 길어서 난독증이 올뻔했다ㅋㅋㅋ

쉽게 말해 k, m, n 세 숫자가 들어오는데, k는 동형 우성, m은 이형, n은 동형 열성인 부모의 숫자일 때 부모 세대를 랜덤하게 교배했을 경우 자식이 우성 표현형이 나타날 확률은? 이란 문제다.

쉽지 않다고? ㅋㅋㅋ 나도 헷갈린다. 다시 자세히 들여다보자.

<!--description-->

AA가 k명, Aa가 m명, aa가 n명 있을 때, 이들을 막 교배시키면 다음과 같은 조합이 나온다.

1) AA-AA: 모든 자식이 AA이므로 100% 우성

2) AA-Aa: 모든 자식이 AA 또는 Aa이므로 100% 우성

3) AA-aa: 모든 자식이 AA 또는 Aa이므로 100% 우성

4) Aa-AA: 2와 동일, 100% 우성

5) Aa-Aa: AA:Aa:aa = 1:2:1이므로 3/4 확률로 우성. 멘델의 1법칙 또는 우열의 법칙으로 유명하다.

6) Aa-aa: Aa:aa = 1:1이므로 1/2 확률로 우성.

7) aa-AA: 3과 동일, 100% 우성

8) aa-Aa: 6과 동일, 100% 우성

9) aa-aa: 모든 자식이 aa이므로 100% 열성

따라서 ```total = k + m + n```이라고 했을 때 랜덤 교배의 결과로 나온 자식들이 우성 표현형일 확률은, 6명의 부모 중 부모 2명을 고르는 조합을 고려했을 때, 그 결과는 아래 코드와 같다. ~~사실 수식을 쓰려고 했는데, 수식이 너무 더러워져서 그냥 안썼다ㅎㅎ~~

이전과 다르게 iostream을 고려하지 않고 하나의 함수만 덩그러니 있는걸 볼 수 있는데, 이번 기회에 모든 계산을 C++용 biology 계산 모듈로 아키텍처 디자인해서 새로 리팩토링했고, 문제를 푸는 부분 자체는 헤더랑 다른 실행파일로 분리했기 때문이다. 자세한 내용은 [https://github.com/panda5176/ALSBIA](https://github.com/panda5176/ALSBIA) 여기서 보거나, 추후 해당 리팩토링 내용에 대한 글을 쓰도록 하겠다.

**Solution)**

```c++
// Copyright 2021 panda5176

#include "include/algorithms.h"

float calc_mendels_1st_law(int homo_dominant, int hetero, int homo_recessive) {
  float homo_dominant_f = static_cast<float>(homo_dominant);
  float hetero_f = static_cast<float>(hetero);
  float homo_recessive_f = static_cast<float>(homo_recessive);

  float total_parents = homo_dominant_f + hetero_f + homo_recessive_f;
  float dominant_offspring
    = homo_dominant_f / total_parents
    + hetero_f / total_parents
      * (homo_dominant_f
        + (hetero_f - 1) * (3.0 / 4.0)
        + homo_recessive_f * (1.0 / 2.0))
      / (total_parents - 1.0)
    + homo_recessive_f / total_parents
      * (homo_dominant_f + hetero_f * (1.0 / 2.0))
      / (total_parents - 1.0);

  return dominant_offspring;
}
```
